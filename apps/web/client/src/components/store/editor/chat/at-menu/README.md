# @ Menu Folder Navigation

This document describes the folder navigation feature in the @ menu component.

## Overview

When a user types an @-mention followed by a forward slash (`/`), the @ menu will show child files and folders within the specified folder. This allows users to navigate through the file structure and select specific files.

## Usage

### Basic Folder Navigation

1. Type `@` to open the @ menu
2. Type a folder name followed by `/` (e.g., `@src/`)
3. The menu will show child files and folders within that folder
4. Use arrow keys to navigate and Enter to select

### Examples

- `@src/` - Shows files and folders within the `src` directory
- `@app/` - Shows files and folders within the `app` directory
- `@components/` - Shows files and folders within the `components` directory

### Images Navigation

When a user types `@images/`, the @ menu will show all image files from the project with small thumbnails:

1. Type `@images/` to open the images menu
2. The menu will display all image files with thumbnails
3. Image names match the actual image names in Onlook
4. Small thumbnails are shown on the left of each item name
5. Use arrow keys to navigate and Enter to select

### Brand Navigation

When a user types `@brand/`, the @ menu will show brand-related options:

- `@brand/` - Shows Colors and Typography options

### Pages Navigation

When a user types `@pages/`, the @ menu will show all pages from the project:

1. Type `@pages/` to open the pages menu
2. The menu will display all pages from the project
3. Page names match the actual page names in Onlook
4. Use arrow keys to navigate and Enter to select

## Implementation Details

### Data Providers

The `AtMenuDataProviders` class includes methods for folder navigation:

- `getChildFiles(folderPath: string)` - Returns files within a specific folder
- `getChildFolders(folderPath: string)` - Returns folders within a specific folder
- `getChildItems(folderPath: string)` - Returns all child items (files and folders) within a specific folder
- `getImagesChildItems()` - Returns all image files with thumbnails
- `getBrandChildItems()` - Returns brand-related child items
- `getPagesChildItems()` - Returns all pages from the project

### Menu State

The menu tracks folder context using the `currentFolderContext` state, which displays a breadcrumb showing the current folder being navigated.

### Input Handling

The chat input component detects folder navigation patterns using regex:
- Pattern: `/^([^\/]+)\/$/` - Matches folder names followed by `/`
- When detected, the search query is updated to trigger folder navigation mode

### Selection Handling

When a user selects a child file from folder navigation:
1. The entire folder mention (e.g., `@src/`) is replaced with the selected file (e.g., `@index.ts`)
2. A space is automatically added after the file name
3. The menu closes and returns to normal input mode

## UI Features

### Breadcrumb Display

When navigating into a folder, a breadcrumb is shown at the top of the menu indicating the current folder context.

### Thumbnail Support

For image items in the `@images/` view, small thumbnails are displayed on the left side of each item name. The thumbnails are generated from the actual image files and provide a visual preview.

### Icon Fallback

If a thumbnail fails to load, the system automatically falls back to showing the appropriate icon for the file type.

## Supported Image Formats

The `@images/` functionality supports the following image file formats:
- JPG/JPEG
- PNG
- GIF
- BMP
- WebP
- SVG
- ICO
- TIFF/TIF

## Technical Implementation

### Image URL Generation

Image thumbnails are generated by:
1. Reading image files from the sandbox
2. Converting file paths to proper URLs using the sandbox session URL
3. Displaying the images as small thumbnails in the menu

### Error Handling

- If an image fails to load, the system falls back to showing the file icon
- If no sandbox URL is available, thumbnails are not displayed
- Empty or invalid image files are filtered out

### Performance

- Images are loaded on-demand when the `@images/` menu is opened
- Thumbnails are cached by the browser for better performance
- Only image files are processed, other file types are ignored