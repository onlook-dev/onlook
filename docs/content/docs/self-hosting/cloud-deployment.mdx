---
title: Cloud Deployment
description: Enterprise cloud deployment for Onlook with auto-scaling and high availability
---

# Cloud Deployment

Deploy Onlook to cloud infrastructure for enterprise production environments with auto-scaling, high availability, and advanced monitoring capabilities.

## Overview

This deployment method provides:
- **Auto-scaling**: Automatic capacity adjustment based on demand
- **High availability**: Multi-zone deployment with failover
- **Managed services**: Cloud-native databases and storage
- **Enterprise security**: VPC, IAM roles, security groups
- **Monitoring**: Integrated logging and metrics
- **Compliance**: SOC2, GDPR, HIPAA-ready infrastructure

## Prerequisites

**Required Tools:**
- [Terraform](https://terraform.io) 1.0+
- Cloud CLI: `gcloud`, `aws`, or `az`
- [kubectl](https://kubernetes.io/docs/tasks/tools/) (for Kubernetes deployments)
- Docker (for building custom images)

**Cloud Provider Setup:**
- Active cloud account with billing enabled
- Appropriate IAM permissions for resource creation
- Domain name for production deployments (optional)

## Architecture

### Cloud Infrastructure Components

**Compute:**
- Container orchestration (GKE, EKS, or AKS)
- Auto-scaling groups
- Load balancers with SSL termination

**Data Layer:**
- Managed PostgreSQL (Cloud SQL, RDS, Azure Database)
- Redis cache for session management
- Object storage (GCS, S3, Azure Blob)

**Security:**
- VPC with private subnets
- Security groups and firewall rules
- IAM roles and service accounts
- SSL/TLS certificates

**Monitoring:**
- Cloud monitoring and logging
- Application performance monitoring
- Health checks and alerting

## Google Cloud Platform (GCP)

### 1. Setup GCP Project

```bash
# Authenticate with GCP
gcloud auth login
gcloud auth application-default login

# Create project
export PROJECT_ID="onlook-production"
gcloud projects create $PROJECT_ID
gcloud config set project $PROJECT_ID
gcloud billing projects link $PROJECT_ID --billing-account=YOUR_BILLING_ACCOUNT

# Enable required APIs
gcloud services enable compute.googleapis.com
gcloud services enable container.googleapis.com
gcloud services enable sql.googleapis.com
gcloud services enable storage.googleapis.com
gcloud services enable cloudbuild.googleapis.com
```

### 2. Infrastructure as Code

Create a Terraform configuration for GCP deployment:

```hcl
# main.tf
terraform {
  required_providers {
    google = {
      source  = "hashicorp/google"
      version = "~> 5.0"
    }
  }
}

provider "google" {
  project = var.project_id
  region  = var.region
}

# VPC Network
resource "google_compute_network" "onlook_vpc" {
  name                    = "onlook-vpc"
  auto_create_subnetworks = false
}

resource "google_compute_subnetwork" "onlook_subnet" {
  name          = "onlook-subnet"
  ip_cidr_range = "10.0.0.0/16"
  region        = var.region
  network       = google_compute_network.onlook_vpc.id
}

# GKE Cluster
resource "google_container_cluster" "onlook_cluster" {
  name     = "onlook-cluster"
  location = var.region
  network  = google_compute_network.onlook_vpc.name
  subnetwork = google_compute_subnetwork.onlook_subnet.name

  initial_node_count = 1
  remove_default_node_pool = true

  workload_identity_config {
    workload_pool = "${var.project_id}.svc.id.goog"
  }
}

resource "google_container_node_pool" "onlook_nodes" {
  name       = "onlook-node-pool"
  location   = var.region
  cluster    = google_container_cluster.onlook_cluster.name
  node_count = 2

  autoscaling {
    min_node_count = 1
    max_node_count = 10
  }

  node_config {
    machine_type = "e2-standard-4"
    disk_size_gb = 100
    
    oauth_scopes = [
      "https://www.googleapis.com/auth/cloud-platform"
    ]
  }
}

# Cloud SQL Instance
resource "google_sql_database_instance" "onlook_db" {
  name             = "onlook-db"
  database_version = "POSTGRES_15"
  region           = var.region
  deletion_protection = false

  settings {
    tier = "db-custom-2-8192"
    
    backup_configuration {
      enabled = true
      start_time = "03:00"
    }
    
    ip_configuration {
      ipv4_enabled    = true
      private_network = google_compute_network.onlook_vpc.id
    }
  }
}

resource "google_sql_database" "onlook_database" {
  name     = "onlook"
  instance = google_sql_database_instance.onlook_db.name
}

# Cloud Storage Bucket
resource "google_storage_bucket" "onlook_storage" {
  name     = "${var.project_id}-onlook-storage"
  location = var.region
  
  versioning {
    enabled = true
  }
}

# Load Balancer
resource "google_compute_global_address" "onlook_ip" {
  name = "onlook-ip"
}
```

### 3. Deploy with Terraform

```bash
# Initialize Terraform
terraform init

# Create terraform.tfvars
cat > terraform.tfvars << EOF
project_id = "onlook-production"
region     = "us-central1"
domain     = "onlook.yourdomain.com"
EOF

# Plan and apply
terraform plan
terraform apply
```

### 4. Deploy Application

```bash
# Get cluster credentials
gcloud container clusters get-credentials onlook-cluster --region=us-central1

# Create Kubernetes manifests
kubectl create namespace onlook

# Deploy Onlook
kubectl apply -f k8s/
```

## Amazon Web Services (AWS)

### 1. Setup AWS

```bash
# Configure AWS credentials
aws configure

# Create S3 bucket for Terraform state
aws s3 mb s3://onlook-terraform-state
```

### 2. EKS Deployment

```hcl
# AWS Terraform configuration
provider "aws" {
  region = var.aws_region
}

# VPC
module "vpc" {
  source = "terraform-aws-modules/vpc/aws"
  
  name = "onlook-vpc"
  cidr = "10.0.0.0/16"
  
  azs             = ["${var.aws_region}a", "${var.aws_region}b"]
  private_subnets = ["10.0.1.0/24", "10.0.2.0/24"]
  public_subnets  = ["10.0.101.0/24", "10.0.102.0/24"]
  
  enable_nat_gateway = true
  enable_vpn_gateway = true
}

# EKS Cluster
module "eks" {
  source = "terraform-aws-modules/eks/aws"
  
  cluster_name    = "onlook-cluster"
  cluster_version = "1.28"
  
  vpc_id     = module.vpc.vpc_id
  subnet_ids = module.vpc.private_subnets
  
  node_groups = {
    main = {
      desired_capacity = 2
      max_capacity     = 10
      min_capacity     = 1
      
      instance_types = ["t3.large"]
    }
  }
}

# RDS Instance
resource "aws_db_instance" "onlook_db" {
  identifier = "onlook-db"
  
  engine         = "postgres"
  engine_version = "15.4"
  instance_class = "db.t3.micro"
  
  allocated_storage     = 100
  max_allocated_storage = 1000
  
  db_name  = "onlook"
  username = "onlook"
  password = var.db_password
  
  vpc_security_group_ids = [aws_security_group.rds.id]
  db_subnet_group_name   = aws_db_subnet_group.onlook.name
  
  backup_retention_period = 7
  backup_window          = "03:00-04:00"
  
  skip_final_snapshot = true
}
```

## Microsoft Azure

### 1. Setup Azure

```bash
# Login to Azure
az login

# Create resource group
az group create --name onlook-rg --location eastus
```

### 2. AKS Deployment

```hcl
# Azure Terraform configuration
provider "azurerm" {
  features {}
}

# Resource Group
resource "azurerm_resource_group" "onlook" {
  name     = "onlook-rg"
  location = var.location
}

# AKS Cluster
resource "azurerm_kubernetes_cluster" "onlook" {
  name                = "onlook-aks"
  location            = azurerm_resource_group.onlook.location
  resource_group_name = azurerm_resource_group.onlook.name
  dns_prefix          = "onlook"

  default_node_pool {
    name       = "default"
    node_count = 2
    vm_size    = "Standard_D2_v2"
  }

  identity {
    type = "SystemAssigned"
  }
}

# PostgreSQL Database
resource "azurerm_postgresql_flexible_server" "onlook" {
  name                = "onlook-db"
  resource_group_name = azurerm_resource_group.onlook.name
  location            = azurerm_resource_group.onlook.location
  
  sku_name   = "B_Standard_B1ms"
  storage_mb = 32768
  version    = "15"
  
  administrator_login    = "onlook"
  administrator_password = var.db_password
}
```

## Kubernetes Deployment

### Application Manifests

```yaml
# k8s/namespace.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: onlook

---
# k8s/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: onlook-config
  namespace: onlook
data:
  NODE_ENV: "production"
  NEXT_PUBLIC_SUPABASE_URL: "https://your-supabase-url"

---
# k8s/secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: onlook-secrets
  namespace: onlook
type: Opaque
stringData:
  SUPABASE_SERVICE_ROLE_KEY: "your-service-role-key"
  OPENROUTER_API_KEY: "your-openrouter-key"
  NEXTAUTH_SECRET: "your-nextauth-secret"

---
# k8s/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: onlook-web
  namespace: onlook
spec:
  replicas: 3
  selector:
    matchLabels:
      app: onlook-web
  template:
    metadata:
      labels:
        app: onlook-web
    spec:
      containers:
      - name: onlook-web
        image: onlook/web:latest
        ports:
        - containerPort: 3000
        envFrom:
        - configMapRef:
            name: onlook-config
        - secretRef:
            name: onlook-secrets
        resources:
          requests:
            memory: "512Mi"
            cpu: "250m"
          limits:
            memory: "1Gi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /api/health
            port: 3000
          initialDelaySeconds: 30
          periodSeconds: 10

---
# k8s/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: onlook-web-service
  namespace: onlook
spec:
  selector:
    app: onlook-web
  ports:
  - port: 80
    targetPort: 3000
  type: ClusterIP

---
# k8s/ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: onlook-ingress
  namespace: onlook
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
spec:
  tls:
  - hosts:
    - onlook.yourdomain.com
    secretName: onlook-tls
  rules:
  - host: onlook.yourdomain.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: onlook-web-service
            port:
              number: 80
```

## Container Images

### Building Custom Images

```dockerfile
# Dockerfile
FROM node:20-alpine AS base
RUN npm install -g bun

# Dependencies
FROM base AS deps
WORKDIR /app
COPY package.json bun.lock* ./
RUN bun install --frozen-lockfile

# Builder
FROM base AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .
RUN bun run build

# Runner
FROM base AS runner
WORKDIR /app
ENV NODE_ENV=production

RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

COPY --from=builder /app/public ./public
COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./
COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static

USER nextjs

EXPOSE 3000
ENV PORT=3000

CMD ["node", "server.js"]
```

### Build and Push Images

```bash
# Build images
docker build -t onlook/web:latest .
docker build -t onlook/preload:latest ./apps/web/preload
docker build -t onlook/template:latest ./apps/web/template

# Push to registry (example: Google Container Registry)
docker tag onlook/web:latest gcr.io/${PROJECT_ID}/onlook-web:latest
docker push gcr.io/${PROJECT_ID}/onlook-web:latest
```

## Monitoring & Observability

### Cloud Monitoring Setup

```yaml
# k8s/monitoring.yaml
apiVersion: v1
kind: ServiceMonitor
metadata:
  name: onlook-metrics
  namespace: onlook
spec:
  selector:
    matchLabels:
      app: onlook-web
  endpoints:
  - port: metrics
    interval: 30s
    path: /api/metrics

---
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: onlook-alerts
  namespace: onlook
spec:
  groups:
  - name: onlook
    rules:
    - alert: OnlookHighErrorRate
      expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.1
      for: 5m
      annotations:
        summary: "High error rate in Onlook"
```

### Logging Configuration

```yaml
# Fluentd or similar log aggregation
apiVersion: v1
kind: ConfigMap
metadata:
  name: fluentd-config
data:
  fluent.conf: |
    <source>
      @type tail
      path /var/log/containers/*onlook*.log
      pos_file /var/log/fluentd-containers.log.pos
      tag kubernetes.*
      format json
    </source>
    
    <match kubernetes.**>
      @type google_cloud
      project_id "#{ENV['PROJECT_ID']}"
      zone "#{ENV['ZONE']}"
    </match>
```

## Security Best Practices

### Network Security

```yaml
# k8s/network-policy.yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: onlook-network-policy
  namespace: onlook
spec:
  podSelector:
    matchLabels:
      app: onlook-web
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          name: ingress-nginx
    ports:
    - protocol: TCP
      port: 3000
  egress:
  - to: []
    ports:
    - protocol: TCP
      port: 443
    - protocol: TCP
      port: 5432
```

### RBAC Configuration

```yaml
# k8s/rbac.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: onlook-service-account
  namespace: onlook

---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: onlook-role
  namespace: onlook
rules:
- apiGroups: [""]
  resources: ["pods", "services", "configmaps"]
  verbs: ["get", "list", "watch"]

---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: onlook-role-binding
  namespace: onlook
subjects:
- kind: ServiceAccount
  name: onlook-service-account
  namespace: onlook
roleRef:
  kind: Role
  name: onlook-role
  apiGroup: rbac.authorization.k8s.io
```

## Backup & Disaster Recovery

### Database Backup

```bash
# Automated database backup script
#!/bin/bash
BACKUP_DIR="/backups"
DATE=$(date +%Y%m%d_%H%M%S)
DB_NAME="onlook"

# Create backup
pg_dump -h $DB_HOST -U $DB_USER -d $DB_NAME > $BACKUP_DIR/onlook_backup_$DATE.sql

# Upload to cloud storage
gsutil cp $BACKUP_DIR/onlook_backup_$DATE.sql gs://onlook-backups/

# Cleanup old backups (keep 30 days)
find $BACKUP_DIR -name "onlook_backup_*.sql" -mtime +30 -delete
```

### Application State Backup

```yaml
# k8s/backup-cronjob.yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: onlook-backup
  namespace: onlook
spec:
  schedule: "0 2 * * *"
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: backup
            image: postgres:15
            command:
            - /bin/bash
            - -c
            - |
              pg_dump -h $DB_HOST -U $DB_USER -d onlook > /backup/onlook_$(date +%Y%m%d).sql
              gsutil cp /backup/onlook_$(date +%Y%m%d).sql gs://onlook-backups/
            env:
            - name: DB_HOST
              value: "postgres-service"
            - name: DB_USER
              value: "onlook"
            - name: PGPASSWORD
              valueFrom:
                secretKeyRef:
                  name: postgres-secret
                  key: password
          restartPolicy: OnFailure
```

## Cost Optimization

### Resource Limits

```yaml
# Optimized resource allocation
resources:
  requests:
    memory: "256Mi"
    cpu: "100m"
  limits:
    memory: "512Mi"
    cpu: "300m"
```

### Auto-scaling Configuration

```yaml
# k8s/hpa.yaml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: onlook-hpa
  namespace: onlook
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: onlook-web
  minReplicas: 2
  maxReplicas: 20
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
```

## Maintenance & Updates

### Rolling Updates

```bash
# Update deployment with new image
kubectl set image deployment/onlook-web onlook-web=onlook/web:v2.0.0 -n onlook

# Monitor rollout
kubectl rollout status deployment/onlook-web -n onlook

# Rollback if needed
kubectl rollout undo deployment/onlook-web -n onlook
```

### Database Migrations

```bash
# Run database migrations
kubectl create job --from=cronjob/db-migrate db-migrate-$(date +%s) -n onlook
```

## Support & Resources

- **Cloud Provider Documentation**: 
  - [GKE](https://cloud.google.com/kubernetes-engine/docs)
  - [EKS](https://docs.aws.amazon.com/eks/)
  - [AKS](https://docs.microsoft.com/en-us/azure/aks/)
- **Kubernetes**: [kubernetes.io](https://kubernetes.io/docs/)
- **Terraform**: [terraform.io](https://terraform.io/docs/)
- **Onlook Repository**: [github.com/onlook-dev/onlook](https://github.com/onlook-dev/onlook)